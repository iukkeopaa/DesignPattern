### 工厂方法

定义了一个创建对象的接口，但由子类决定要实例化哪个类。工厂方法把实例化操作推迟到子类。

在简单工厂中，创建对象的是另一个类，而在工厂方法中，是由子类来创建对象。


### 工厂方法优缺点


* 优点：用户只需要关系所需产品对应的工厂，无须关心创建细节；加入新产品符合开闭原则，提高可扩展性。
* 缺点：类的个数容易过多，增加复杂度；增加了系统的抽象性和理解难度。
* 工厂方法模式非常符合“开闭原则”，当需要增加一个新产品时，我们只需要增加一个具体的产品类和与之对应的具体工厂即可，无须关系产品的创建过程，甚至连具体的产品类名称都不需要知道。虽然他很好的符合了“开闭原则”，但是由于每新增一个新产品时就需要增加两个类，这样势必就会导致系统的复杂度增加。

*

### 工厂方法模式通常适用于以下场景。

客户只知道创建产品的工厂名，而不知道具体的产品名。如 TCL 电视工厂、海信电视工厂等。

创建对象的任务由多个具体子工厂中的某一个完成，而抽象工厂只提供创建产品的接口。

客户不关心创建产品的细节，只关心产品的品牌。

### 那什么时候该用工厂方法模式，而非简单工厂模式呢？

基于这个设计思想，当对象的创建逻辑比较复杂，不只是简单的 new 一下就可以，而是要
组合其他类对象，做各种初始化操作的时候，我们推荐使用工厂方法模式，将复杂的创建逻
辑拆分到多个工厂类中，让每个工厂类都不至于过于复杂。而使用简单工厂模式，将所有的
创建逻辑都放到一个工厂类中，会导致这个工厂类变得很复杂。

除此之外，在某些场景下，如果对象不可复用，那工厂类每次都要返回不同的对象。如果我
们使用简单工厂模式来实现，就只能选择第一种包含 if 分支逻辑的实现方式。如果我们还
想避免烦人的 if-else 分支逻辑，这个时候，我们就推荐使用工厂方法模式。

### 当创建逻辑比较复杂，是一个“大工程”的时候，我们就考虑使用工厂模式，封装对象的创建过程，将对象的创建和使用相分离，何为创建逻辑比较复杂呢？


* 第一种情况：类似规则配置解析的例子，代码中存在 if-else 分支判断，动态地根据不同
的类型创建不同的对象。针对这种情况，我们就考虑使用工厂模式，将这一大坨 if-else
创建对象的代码抽离出来，放到工厂类中。
* 还有一种情况，尽管我们不需要根据不同的类型创建不同的对象，但是，单个对象本身
的创建过程比较复杂，比如前面提到的要组合其他类对象，做各种初始化操作。在这种
情况下，我们也可以考虑使用工厂模式，将对象的创建过程封装到工厂类中。


对于第一种情况，当每个对象的创建逻辑都比较简单的时候，我推荐使用简单工厂模式，将
多个对象的创建逻辑放到一个工厂类中。当每个对象的创建逻辑都比较复杂的时候，为了避
免设计一个过于庞大的简单工厂类，我推荐使用工厂方法模式，将创建逻辑拆分得更细，每
个对象的创建逻辑独立到各自的工厂类中。同理，对于第二种情况，因为单个对象本身的创
建逻辑就比较复杂，所以，我建议使用工厂方法模式。

除了刚刚提到的这几种情况之外，如果创建对象的逻辑并不复杂，那我们就直接通过 new
来创建对象就可以了，不需要使用工厂模式。


### 判断要不要使用工厂模式的最本质的参考标准。


* 封装变化：创建逻辑有可能变化，封装成工厂类之后，创建逻辑的变更对调用者透明。
* 代码复用：创建代码抽离到独立的工厂类之后可以复用。
* 隔离复杂性：封装复杂的创建逻辑，调用者无需了解如何创建对象。
* 控制复杂度：将创建代码抽离出来，让原本的函数或类职责更单一，代码更简洁